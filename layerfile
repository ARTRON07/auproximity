#This is an example webapp.io configuration for NodeJS
FROM vm/ubuntu:18.04
# To note: Layerfiles create VMs, *not* containers!

# Install node
RUN curl -sL https://deb.nodesource.com/setup_12.x | bash && \
    apt install nodejs && \
    rm -f /etc/apt/sources.list.d/nodesource.list
RUN npm install -g http-server

COPY . .
#!/bin/bash
RUN set -euo pipefail
RUN npm install -g yarn

# NOTE: select your desired commit in advance using Git

# Build backend
RUN yarn
RUN yarn build

# Build frontend
RUN pushd auproximity-webui
RUN yarn
# NOTE: because the frontend is served by Nginx, this immediately sets the new frontend live
RUN yarn build
#RUN popd

# Restart the backend
#RUN pm2 reload 0